// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.17;

import "forge-std/Test.sol";
import "@source/modules/OptimismKeyStoreProofModule/KnownStateRootWithHistory.sol";
import "@source/modules/OptimismKeyStoreProofModule/KeystoreProof.sol";
import "@source/modules/OptimismKeyStoreProofModule/IL1Block.sol";
contract MockL1Block is IL1Block{
	 function hash() external returns(bytes32){
		return hex"807bd796a85a0fede42edf1561832c5ee0a0d1e8819406d9bbcb64c0ccb343c9";
	 }
}

contract KeystoreTest is Test {
    KnownStateRootWithHistory knownStateRootWithHistory;
    MockL1Block mockL1Block;
    KeystoreProof keystoreProofContract;

    function setUp() public {
	mockL1Block = new MockL1Block();
	knownStateRootWithHistory = new KnownStateRootWithHistory(address(mockL1Block));
	keystoreProofContract = new KeystoreProof(0xACB5b53F9F193b99bcd8EF8544ddF4c398DE24a3,address(knownStateRootWithHistory));
    }
    function test_mockL1BlockReturn() public {
	bytes32 returnHash = mockL1Block.hash();
	assertEq(returnHash, hex"807bd796a85a0fede42edf1561832c5ee0a0d1e8819406d9bbcb64c0ccb343c9");
    }
    function test_insertNewStateRoot() public {
	/*
	{
		"baseFeePerGas": "0x306",
		"difficulty": "0x0",
		"extraData": "0xd883010b04846765746888676f312e32302e32856c696e7578",
		"gasLimit": "0x1c9c380",
		"gasUsed": "0xee71f2",
		"hash": "0x807bd796a85a0fede42edf1561832c5ee0a0d1e8819406d9bbcb64c0ccb343c9",
		"logsBloom": "0x0d2502c20273d10d3c72449ba61761c43c39f7503b44186741870c1ab891343f40b214e10b652b4200180568959d84dcfb6b0812c802aa4003311e04926c2a600a43c6aa4e7760926a084b3b10a882a4c5598272f76638218692c0a682e42ac904e4b1d992e40ac124c681ed885008281858c8e52cea25c0113542f45712f06e0b0221f4d4e4712b62400d41f0200436980dce812b0513ae3507a3c0154240460388181c76c022514a00a7a669334b6306020341e1552184819119e66221826299b458e241b4ac0ec09a2681ad13460d2e4a50a01280293482c16ea20cceeb621c101225a2e07311b932035c60505020029190604b9223430a7cb148280106b1",
		"miner": "0x94750381be1aba0504c666ee1db118f68f0780d4",
		"mixHash": "0x10395f604f9dda9b4b54dc3a36d25d10fa5d236d3c814f3f076e36bbaa481fd9",
		"nonce": "0x0000000000000000",
		"number": "0x8d7c6e",
		"parentHash": "0x939dcdd4ae703cb363c372a248d96e1a8fc06ef9825ea4051d762532ffddd33e",
		"receiptsRoot": "0x1216d866ad3647bd72a9e6ad8cd8dfff9bc885630c04376afb0c735aed97ffd3",
		"sha3Uncles": "0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",
		"size": "0x21f39",
		"stateRoot": "0xe5f3f63ed5cf0a5c3e15efe0df467a35fde185f16d75a500430f805adea94345",
		"timestamp": "0x64a03d60",
		"totalDifficulty": "0xa4a470",
		"transactions": ["0x24349f5b7301c6856704c0e7387b379545eef14b889cc3b1667fac6163cb6538", "0xfddc61292405eda48c772fd10987cf8d8c175e9911ab5fc2769d6205c9fbd016", "0x040c0ae97c622cbbe8a6039e2a3f0993e28121e19c6fdc75f9bbf8a14823caac", "0xcfb19524552accce74246145856fc43343e822f9a4fbd0658294d723a4ff5b8c", "0xcd71605a7f5c7add29630e3d45675794c14a6147e8ea743c749576bcb2991b3e", "0x29448331a3d0bcc5c7da4144c6ddde4005142772cc51ada1c5489a0e56d2c3ee", "0xfb86960c812d3688a273698bc62971398e0df4c7008cf60f4ae2b26f7e670c16", "0xa537bc8d9161f02f85ba4eec66fd18035cc2c600cf2cdacacae5b716d4d0742e", "0xd95615a0b5c1c47387d75f95198f9ea9222b766df826a24153eb77eae0aa2cca", "0xca62e6cfdeff2029368aa01b1a97d3d8dd6d8813c6b4d6c06e0f0f4110ea40d8", "0x96e21287332530094b62980b8151a170f9933938a6f070a56e651abf197eb22b", "0x2af73306561ad042640e7572f8313e0eb10df9df1865850c05e952d5f39d15f0", "0x1cb55a60790de4ae4bd67a6afa0ef7b39cbb9a55f778164040471f29c591c86a", "0xb94d82e758325ba6c79a4ab40d36293c512991b9233b8117096dd3631963a5b1", "0x9a5d8289ee863525a76b1f0b47952509185945c099ffb4f601d8a007e0b6e4f7", "0x6e55900a8fa3246cf2f3e034c02c1b93198c34e18263b66d046ed2a9956ca4e7", "0x66554a4245619fdb1b0598d5e450b31575c1a3b0dc05a8138aa548fd7d6f02e4", "0xf6aa1e9c4cad3c274b55072269549899a5909780fb82d7be2084612965217ebf", "0xfd62ae44cb7a34f1ca6e6213f4f889f4cbb6cbd6662b3eb9a570d3b6b3a02100", "0x7ebaf40bfe9d0310d0c24b820ea6340c80a4f110df916e0e89f0afeae640d914", "0x58bfcaab6e17a956f185214bfb3c5f1b8f30dec5e2a8a3e6c3fe51b3e96d7132", "0x087401d653d79897e554ab0a928f1432d15084ad2a31e71956e9954be6d610f0", "0xba8a292557472158139ad17eb82e8beedeb17b57cb6d6ae1f119ca7722642018", "0x1989fdafbf19e075bc7cb45edaf6ae202ca28d9095ca7eb6a478cd6e10a6183b", "0xae6e4316fecc4464348ba03bac637497a1646b6e0d6ca65587c329be784f8ac9", "0x22e4861d0ae5317f6a0012116186c9a7c5a12a4d79e4dff3d93a4ad10f18734c", "0x0b7651bf733fba51294fa437acd65a42d84d9860f2413494b8a10e252a217b5c", "0x26b9c92402b970b7ea68a8c205d07337487cb513b9e24d26355db4439389b12d", "0xada23d2935f4755b153c5acb7af9ee3e6d2b6199b2fda575e7a31a68266d2750", "0x35e8f29d30488b338afe901e710f2560c3e745983972b2e0884312b2b503f25c", "0x003e501cc6ca232aaceb5fca64cc61da997eaeffc531e13224fa36fd983a71d8", "0x2c2814960f500ba76ee0a45ab501855fcb4a65dc009d2f90f86e97c94bfd3839", "0x254ae003e4cefd8bbfe9d953c01be89d9b248ac31e6002ec71a770a8a985857f", "0x1aba212a3a66600421b2b81663ba984351e6029eb7b2634fca746989356fcfe3", "0x5600a4d3414f5f9032ef4c881e04a55925995af695740a71a11f598df7fd6c6c", "0x6f1db9e77fba7b7a610435338464b050381055cd91f91d4c965e100fa821eff7", "0xadd2502eced4bd1bbd115d55910ebc55381bf7dc759426c967920370c3b0a714", "0x82d71acba38e4353b52c1848bae652109f7a7754d7619fe8cbc299ae08ba44a7", "0x8dd68666fe288107df99eff665257b84081dbc1db9f97246416162100d4f90ad", "0xcba8eac1ad92d2350b2e4b60e0804cc3c0f57a4b7bb1d2c0448eca7c146e55b3", "0x01765f80930bf5982a36e7224e54f9eb5815ebe0537d0b8c23f4cf0f85f90e1d", "0x32cc107e8ba19fcde5f2f5bbd407ff9c77f5de75ef2500453e902f7d56babecf", "0xa43a709f7dd4339f6bf5daa702c429b2f34dd9893b0f9c737cb18a27e966d26f", "0x2c5a5f17f32574e1155307bbc616f953fa17b2f57761258148e26bfd7165a83c", "0xa8063764036621035690f21e94c4f506ceb13e440f28dcc442142951ab47c527", "0x2709fe606ddd836f6b2cc775747e29910302a9dd9f0cadc50d248e005acf09ba", "0xf3755144a733a35f89a790bbde2bf21f7b5ce13bb3f440d1d003c4a5dc8add8d", "0xf26f28bb222f8e780be07f0a3188a4265c62877c3d9af004941b72f6a1f733bc", "0xaf4409dcaf39802314a0531137963154c84796b3229e032c7a41972bfc9c4484", "0x1b7814faf22c1835521557cfa2968688147131fa8862cad0227e0feef864c757", "0x73289584d3ecee522601ca051c4f2e55ca30c82c702410b39d3b4c28b4322b6a", "0x9e6625aec8a80ee830955381569dfe6821e5fef79feef530e443d9088c12017a", "0x9fa341a1b6533960e6b644cf21d0322ec850faec567e5d9a9818760b58393852", "0xe2be35f19c685428ba26626d110f9764d5265d9f414ec0785406488b23b877ec", "0x8574c3fc17e7b0de8fac82ace8b9b3260f809c7b88b96641e897e2d2b80a71c8", "0xcd48aa76a9f1a1abc30880e4e66568044bc955b46cf7759d654d6d1b5f4ac231", "0xf954c17c5e2e7309929e596e53e3340d9a451ca2aace1f44d1b791d4f357afac", "0x95c60fe0a173dbe9eddbe1b23a32f0aa59db1712fa50698abef674400f36e1fc", "0x0bed742ed187c49f660a42993e0f2186399f6388978f52ffa42bb4386efb0936", "0x3311b6fe23fd872af64184fe99303ec94554f1e6a5b4bd7668d5e7fa56f3ac07", "0xb66e18fdda80af38381caacb4c084edd7d49e6b67f630de0f2942f82187a2d7a", "0xf41789f0a493d7b7b88e35ae82c9bb66734fd9c38b46874080a38df33463d562", "0x2f48b6551fed702edd842fb7b80b59282ee14343a2776709f49e9bd43a38959c", "0x12ecb21862f46ad4dcc8e776bc03a343866ff3ccbf70d2ff073f892945948144", "0xfd30b2e88dc7d7969db26e8cd6f3069e077166ae087ffb611efbbc5c482d005c", "0xc4e13618ca572b78d7d6b35c7b675f914e191d065da99f88b5dce3ad72251f99", "0x73f105373d4f9bec6d3da79aabcd1f7fbb2b4052352026b17d888713a2f67e08", "0xe957e6ae59cf3ed6290863e97574ff9b5af449cfe02134b52fe35e073f02f152", "0xd7a24c0bb7f046b1e30e9f0db87072ced393b5e37180912891c1ea3634ceb7bb", "0x2ab055e2ae3989c817775c32c15dbea2f37ada4c5738273ecae2d0e0472d542b", "0xc2a866d6ae5930b0ee7376bca8ac3ed4930304e476585b6fb939512f8b699344", "0xe4f50dc3344d0e498cd3aa8f26b3e5221b536d77482cad04a9ce999029edf4a7", "0xeddc089a12ea42ceed2acee883815d79ef51bfa03b0c2c18b8eaf026c69ae6c9", "0x9b8687e9b26887a891a3b7e16ec3e34eb8715566df1827bd831cf48a4a139f83", "0x6a89043215eff3870eed8333140ba1f35203ea620b872bc2755b1971362893a9", "0xb97a3824db23b897e10f0bed70a38c77b624dd314ded4e9d167064a419cde661", "0x9b92fb573cd382454a5517221f332d0ddabe7809fe3a8397102836e2abf2b149", "0x8b2d9fb12d6512e230b71b8fbb0a775957d87cd33fadf12bcb0495503cbc341c", "0x9f59bccb2b225d44e805971f22a46a124f67f3375c2132342c9c866560bd00f2", "0x2c5141c89b46b56b2092710607098fc2cf4743007491660b638201b70b3c07c8", "0x02499168185c7dfb130a08d767699b77e998147d25192b28059500de7f17174c", "0xd528104cc604b061e7d65d9d7c61ee3226ab68d225b7cebd5d36a072b93bb635", "0x3d21b0ac5c83ff1344efc1654db42681c1bef35c0e171da5bc5025106271091c", "0x84d4781db21cf976ba10d93f9ffe2d47201bfa54df904297ee9612c029540d33", "0xd6113130e6d47095f25178334680857b2b912c7c465334ad142585f9742510c8", "0x9f42faf51de6aa9542dc48d710b3392974b682e159a9ed27c9a0915c074c46b3", "0x28a26bae948df2a13467938c03761330e310dcd1f80462541e10fa7ff03586d2", "0xc38c7b24a654f5a5947225bbfa7cf78524088f94574c14920049981e59c091a3", "0x779658d8a523f031795d0fc523491de0a83b9726b07e66b8cb42d4d8994ccca3", "0x0e91a2943be1877a44af4fc231bb1db044caa7af7f30969427b44c2158a54a75", "0x952b2116395487db3e97a925bf988e111a0ec903a91cb245876dce55667a8357", "0x473c34b5caba73fc115d87a1611d12e5d3dbd9edd3c19b40f3e7f3039950932a", "0x36e3fa278b78a1249a7d4a1f6a1490a1c40d0d3637df523c33110b4aa7828f6e", "0x5d381d80d9c306292129d77e1d397a4178d2f945e8a5c28ff37077d907d07087", "0x269f86deb45eaed120b1c7b657ba07f231e4fd86bf2f8fc6e72ed8a545a00539", "0x9dd4bdb8c85212c4e910ea40546a2dd52051772c732ec0868e3637b69f491862", "0x67fd98c44185f99a8a3f93e4cc85c443262fa5f25522297d21d123bf9049e674", "0xbd571dcc710e180db1eace8e1dbd837488f23881b8402ae4d2dee6bd6eb44aca", "0xdf59c0b633977045d359b971a5c9bfc09220f9624c6a386f7c82fcc8ac2080ea", "0x20674520c9e2d3516b3a55c8d5547bd5481d6f6675e5480770badf3c72aa45e3", "0x63447f1c57f7de86a288f80d704d91918a73881e92ba4a7c49c601d40057c289", "0xa39d3ebe057b563c4fc7ff535d116bfb34e12c3a1ca464a2835c40437638d580", "0x1b636c4b834a5087645a326008969a4ea5dbbf4b71b13f60cd6ef4f3f85d47cf", "0xd306e028287ba42642858d30067f478a5afd15aeeb76a74e81efb43b260e2f84", "0x93f8a292752fdf154fc2aef65eb322df5173f76553b89c6217cf593a77342432", "0x22567ab5d06c1cd6e1093a407a65d0f0258af3bc2f65ec3faa5c58f065457d3d", "0x90d35dfb74783e35e88125a02e2283fbaee150862b96b2b7b5f22473f0f568e2"],
		"transactionsRoot": "0xac1fae9e5a88b2ff9bd1c7c9985f4fae7490ac79d91d8e5356cb95c212c29422",
		"uncles": [],
		"withdrawalsRoot": "0xdf2da8ee290d7ae0d2a5fc1cef38725643955cbe4595ea130330f6dbe22074c3"
	}
	*/
	insertStateRoot();
	(bool result, BlockInfo memory blockinfo)=knownStateRootWithHistory.findStateRootInfo(hex"e5f3f63ed5cf0a5c3e15efe0df467a35fde185f16d75a500430f805adea94345");
	assertEq(result, true);
	assertEq(blockinfo.blockHash, hex"807bd796a85a0fede42edf1561832c5ee0a0d1e8819406d9bbcb64c0ccb343c9");
    }
    function insertStateRoot() internal{
	bytes memory blockInfoParameter  = hex"f90238a0939dcdd4ae703cb363c372a248d96e1a8fc06ef9825ea4051d762532ffddd33ea01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d493479494750381be1aba0504c666ee1db118f68f0780d4a0e5f3f63ed5cf0a5c3e15efe0df467a35fde185f16d75a500430f805adea94345a0ac1fae9e5a88b2ff9bd1c7c9985f4fae7490ac79d91d8e5356cb95c212c29422a01216d866ad3647bd72a9e6ad8cd8dfff9bc885630c04376afb0c735aed97ffd3b901000d2502c20273d10d3c72449ba61761c43c39f7503b44186741870c1ab891343f40b214e10b652b4200180568959d84dcfb6b0812c802aa4003311e04926c2a600a43c6aa4e7760926a084b3b10a882a4c5598272f76638218692c0a682e42ac904e4b1d992e40ac124c681ed885008281858c8e52cea25c0113542f45712f06e0b0221f4d4e4712b62400d41f0200436980dce812b0513ae3507a3c0154240460388181c76c022514a00a7a669334b6306020341e1552184819119e66221826299b458e241b4ac0ec09a2681ad13460d2e4a50a01280293482c16ea20cceeb621c101225a2e07311b932035c60505020029190604b9223430a7cb148280106b180838d7c6e8401c9c38083ee71f28464a03d6099d883010b04846765746888676f312e32302e32856c696e7578a010395f604f9dda9b4b54dc3a36d25d10fa5d236d3c814f3f076e36bbaa481fd9880000000000000000820306a0df2da8ee290d7ae0d2a5fc1cef38725643955cbe4595ea130330f6dbe22074c3";
	knownStateRootWithHistory.insertNewStateRoot(blockInfoParameter);

    }
    /*
    {
		"accountProof": ["0xf90211a01f637d5f303796398f597e281b996d2605cc2b4fa7f0d92c513643130b2ff20da089a7a2558bfc43b22bf94c0489ea272161336304ee073b1eb3cc5d67a43be85aa007c7db44ded4af05e226fde1dd27ebb06036d44578ed72e2f63185fc574824e0a00ede8e8721328c47cbb3a2e74c36f549dd14c09a0233886f1d4e1fc18f401e8ea00cbb12d68dd4b740ea9e800d1199f00a35d692db0ab8e9ed2fb1a47e0f588072a0a58dfae8a87a6c76372b41127b3e2ce6e9ddfd4d1c552aaf9a4454807a882624a00f672733f3345a31bbe321141622c049b0fb179f9ef40c342df8d24e4912cccaa019da89a275da8046764a10939a41273e2061a5b105497511873777caeaa34e1fa092c0b95c8ab716250731ae3392d37199eba20f93c65222f157bdda1512c3e7d6a0b581996823252424ded4070ae4dbeeab5feca24d35ee5a24923ee2d6434aab4fa0c8b33d11e6470163b7bc2744773464988b8b89a5d61d5cf3327d83b513f11023a0914a740d0c687ad4c9cb5e95533ec6c14a9fd4e2ade04109ea6061a5bb726f94a0a7f0abee3b7f32fdca21e33b66529a8104bbc2bf7e5e46ec222a9097fca70d70a07506f196de8b534ebea66c9a6bdebc076a2c2b8018a77e94b77bad166a114d0ba00b33350375aa142e4f252a47713eb1f2f5ba6de5b90d3ea0de5b064fa2524e61a09596f01244c21780adf59571a369b3dbffc23d8dbad7528ebaf3736332f70c8c80", "0xf90211a0b8ac725b8d0be0004a2544eaa1bf2d7f1037254050c9998bf64eee1648e1d408a09fc0959e40bcf9c5a7f59f4c7ef1cabfe7d43cab85ef9560c42e6be2dd4af485a0776349a9b8c554095d740b4882f252f020404aedf775079f11806b675defbd43a0e5248cfb4342291f153b1bb96b5fd3cb13701813fdd3b28658e75fdb4a4c2691a0dd15608767a6e25eb5ef21d326f636cc086656fc30c2705e93bff10203af3400a003f139478e75af0a3a4db50342fc25796740f0b187b94b78afa86e9dea806d61a045de899863a9c9405215907ee020de8c2c3668edf3cfcf4a868abf94b4084241a06b8bf68e0495279360e25598a4b3bd7450578f4cdbbbb618f6ac4cbbc73d0d89a0dafee061e758274bee84f8fa6df933ace88c96618837543ccd752bda16e1b11ca008cb5fd03f8dc430e61ae9228648fbed1a2fcfe81a2341b5a842a1203b912854a0b8d777d015f0b66b25fb3bed354fccf64541108828b7f8dce7cb6f7a2c7b15e8a0d581f43db340358b59476ff853c5a627471c4df2f2baf1fd450b8f9aca650622a0f1bf0b017201301757f432e7559f9231576b38c007d8be227d3ceaff4e9054fba0d3dfd89378794d18044a4e54c96ff60e99308bffdbf29b424d5ab6ec7933566fa0e3234869f8a243407b7cf5280cdb4cdf60866e26f324395c0ba21351d931b4a0a0bab778f165b8c8806d8058abbba694102db5e5898dcf65448e471fc5daf7632680", "0xf90211a0deb9561c8202eeb1088becdc19f2b87cfe94a10497b4fb58c9a1e38ae90a915ca0a466ac165a3e0b1f50b6454c99c10cc5c41503d4f0c3cf871ee5d6b88d3393f1a057e8fb3a3f532083b1ad47c961473608292768bda30208aab18aac186dd7726fa07b412ee1626842fb754ccc72587ea7a058db91da478d1abafc40209cd8ce7df1a055ad83292693cce77321ff7df1807ffac7dea4f1cd1e7501c71c29b1c736a5d9a0b477344d447ee0014bf9021593a4f45ff5beba1b8b78a08a42f2418485038925a072c645d4a2fd1d362b0b5e0489d83ea8cdb8485d35625caf65f1d3a6076bf8c5a02ffda44f5572fc0d077096bf56d754a94896eb2c89fbc56c2a7a3897abbbb2b2a0aebb9af57494d972874f9a72beb9f079765a43ec16baf122d8c1265f78fcc2c6a03095b7311c4a8c6ab593d03a39fe5b41db884a51369822167b8b618f98dbc0eea08b355e0cce07425f2f02ae40385e2b21e0e3da32cb7b0a6f4aba06690a961166a0939d02dfc357824044d3f0cafcb781f46ec45da4b25836f09b682f9536d120efa0dbeda80bd4f404c73d14fba54915f5328fb51ac4e4536a29c586e1cafe214c21a0152540adefc403d3032bdeb54cc74930b29f687945115e2d4cd9494f69ef6844a069a290528dde4285fb8e628ffccbf1fb69b82f5cc5198128b4dc1eabbc765a4ba0e46855e23be7d591137302942bf4637e44a77844294f9a8caae81f13826a689580", "0xf90211a0d5dba92148fb213294b687fefa76f14277ff871a2c6c584d9a0b591a6414de67a012deccc7b0f50a019cb85858f3261d85c4e8b5458712e74f47b65b656d24cacaa07f1791abfc2c5240b5c2ef8667df3d1469a0cdf07131a7df024197f7c9d074eaa0f088f24f3a92c4c2ab2e4fc474c1b92259d1e02a98078b05e57f4a3e80e9fb59a098d73378302969ee6f255f5db38bfa44dc9b0df7674597345f322c24237851efa0460401be8388ad1a8e02d09a662b7c6274c66c1bcdcd2317b2c99e49d283a34ea0f34b5119985bfbdd50feb8c5ccd3bef1f9cceca022bdcea082d541b340a8347ba0de3e68b7e3e64df5b06ca52a615d6c9f00322344f7557bc3c95050b792b86272a06f2c2a0d8e8d27cbac3f02aba212eeb79f80a6868a58c96ba7ae8d0446cce694a049d95d4d82b7defb3d193052598ddbbac648235e383dcbe535a2fc493cd3e39ba0df07b16cbd8a44ea53e8e75d1eebb6ab67fc0e5f2447d8e5768fabf68f02bbc8a038d19ec63584588b2f93cd80c161d1827cf054a2f9cef63d1470654b9c681fcfa0907eaaaa3693594e95941637e9f4c3f83ce02a14cf8fc2cb02418dbdbc043839a0171bd79602ff7c303083d1e3774ed0c77309afdb5be6f12396fce392ba52312da0cb54daa5193ee3efc0e2afbe0a1b13e5418a570220dff9063b322cc07785100ca0a7daeeef3b2e9b542906cd982a7860c1eb8652b776deb2d7db954031a595c06b80", "0xf90211a010a55b10828dc87c870bf7ffc1f17e490bfedef06b447f44d5cb05f987a55192a0998e2744898f5abc5c55a7670eac383e750761ea7873ab929e89882767f9b29fa0e7430cf5391d79c45edcbf4a9f267b95a90b764245987dbfb940f386f1c97eaaa08abfb3ebb057cb9f26960a5ce0ce3b016f85f4b54020928de70f6b0e8efbc6f8a0d2013763bdd3e8138663674d44aa6a01c43a1673590f8f5583354019d047c33fa0bf8c3a2443fa424fafd3041c191b23cb9df88ee80d2a6b2eac62414252aec47fa099081275005ca12f20335b1bea768f1da0625f9c0d6128839169c9036da1c3b2a0b19fd624a64340cdf3134fa715926ec4c9a7bde61e5b7d5ba976339c5d11c6f8a0555cb85d214d24f3f017771c2eea86d3c1e2850cba545eff8f7cf068a6fbe5c5a0deffdb2431042577063cd124835ff348ae4d5d1dbce3cc0da0840cd6bad593d0a074b243b4cbac7dfaf229ec5ed8f960d2c8d8ea74ae2d23853c527e0f284fe6b5a023f1b3c16d7540223ae68038b414a7a8dac63c44d565dbf5b6103a30c2e037a8a0d5fd5c6a69fd42bf9b8393e2a003ba5e09caefccfa5f3afc437baf6276d831f7a0f0b24f2057ef2fda74acbd3eeb37463eb41a59d95b7efdb04071e990af593b7ba0d8a5a745362753801c7d31d8c70d00abf5c298044066a91b164578c20bfce227a03224b86f2f7fcdae70c0bad45c1b743d37f344bc2e62922723624b562765425d80", "0xf90191a08190beca2fa9132ec0e66a0941160b478e8a5d709c445dd8e60a2714e3bf7454a0bb28b0642a3f59da9b458f985a3123f44e11bb66c4a17048cc636b4c381ae45680a0c70b7be01895bc02247cd4c32faa6f395a33437340fbc5281a386bc17f62da0ca08ca208e9e2e0046decaf23092891d897a2c481ecb7baf7d4baa8b79e9463d072a085170ab1325f84f6da3902311f5367b1d7cdc456e2faff883e5f5a77cc06801ea01f7446d0aa0c9105a7d0895b32999e1ca262f4323bfe595fc8c47941159dbb24a09385ff36324631c8ae1eb4d3e40b1bf21e74e4dc8b9a8e914f7312371780d024a05cb9ae2531f250141a58cece3694ab04da3dfa9fe10364b3e955ab0f8d7df27fa0ee414ba7ce4ad05131e96e154a5163328bc0da65a019553d828ead34e5be22b080a01a355ce465305852dad4e8a78749e33fb47eb53723552232d6ff7aba74a1d870a0cb6e0c992b267823039107b3de67893235f7452d75ecc6504ae0d85722fdc0be80a039978eb3ab27721875bc507611aa50434fff2f2f16b27943685f08a40cc9e4628080", "0xf8679e205e7c0ddb68e10d8432e66d6351acc6baf80161e6088af210fee0815cd6b846f8440180a0c451881707b89b35f5b838c07894b6f5eca4a5415941625e5916e3c06870207ca0227a99a2297d05d1bea5114772e59611991c4aa2f1ebb0d23330b02173426c23"],
		"address": "0xacb5b53f9f193b99bcd8ef8544ddf4c398de24a3",
		"balance": "0x0",
		"codeHash": "0x227a99a2297d05d1bea5114772e59611991c4aa2f1ebb0d23330b02173426c23",
		"nonce": "0x1",
		"storageHash": "0xc451881707b89b35f5b838c07894b6f5eca4a5415941625e5916e3c06870207c",
		"storageProof": [{
			"key": "0x5",
			"proof": ["0xf8b1a0baefd740d886a75a00998f859f788b55e7d7db1843b5ed550e8135c3a45e0c1d808080a0df1326d6c2c3e493d1bfff3543916a258519bb6365d62334d217e8a0efd0a19e808080a0670f9fb6e73ff93d538f7cc92c723f51d7df32d94d16848b51289260eb21292c8080a0c2c2ff8fbb388b92799847764ccadb622f5e8464f13c8aec173f8ee8ebda8e2fa0849db0f7b77fc361400b0f26d1e39ebc8f1a421829839c9bafa80be0a14feba680808080", "0xf7a0336b6384b5eca791c62761152d0c79bb0604c104a5fb6f4eb0703f3154bb3db09594f39fd6e51aad88f6f4ce6ab8827279cfffb92266"],
			"value": "0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266"
		}]
	}
    */
    function test_proofL1Keystore() public{
	insertStateRoot();
	keystoreProofContract.proofL1Keystore(hex"0000000000000000000000000000000000000000000000000000000000000005", hex"e5f3f63ed5cf0a5c3e15efe0df467a35fde185f16d75a500430f805adea94345", hex"f90c61f90211a01f637d5f303796398f597e281b996d2605cc2b4fa7f0d92c513643130b2ff20da089a7a2558bfc43b22bf94c0489ea272161336304ee073b1eb3cc5d67a43be85aa007c7db44ded4af05e226fde1dd27ebb06036d44578ed72e2f63185fc574824e0a00ede8e8721328c47cbb3a2e74c36f549dd14c09a0233886f1d4e1fc18f401e8ea00cbb12d68dd4b740ea9e800d1199f00a35d692db0ab8e9ed2fb1a47e0f588072a0a58dfae8a87a6c76372b41127b3e2ce6e9ddfd4d1c552aaf9a4454807a882624a00f672733f3345a31bbe321141622c049b0fb179f9ef40c342df8d24e4912cccaa019da89a275da8046764a10939a41273e2061a5b105497511873777caeaa34e1fa092c0b95c8ab716250731ae3392d37199eba20f93c65222f157bdda1512c3e7d6a0b581996823252424ded4070ae4dbeeab5feca24d35ee5a24923ee2d6434aab4fa0c8b33d11e6470163b7bc2744773464988b8b89a5d61d5cf3327d83b513f11023a0914a740d0c687ad4c9cb5e95533ec6c14a9fd4e2ade04109ea6061a5bb726f94a0a7f0abee3b7f32fdca21e33b66529a8104bbc2bf7e5e46ec222a9097fca70d70a07506f196de8b534ebea66c9a6bdebc076a2c2b8018a77e94b77bad166a114d0ba00b33350375aa142e4f252a47713eb1f2f5ba6de5b90d3ea0de5b064fa2524e61a09596f01244c21780adf59571a369b3dbffc23d8dbad7528ebaf3736332f70c8c80f90211a0b8ac725b8d0be0004a2544eaa1bf2d7f1037254050c9998bf64eee1648e1d408a09fc0959e40bcf9c5a7f59f4c7ef1cabfe7d43cab85ef9560c42e6be2dd4af485a0776349a9b8c554095d740b4882f252f020404aedf775079f11806b675defbd43a0e5248cfb4342291f153b1bb96b5fd3cb13701813fdd3b28658e75fdb4a4c2691a0dd15608767a6e25eb5ef21d326f636cc086656fc30c2705e93bff10203af3400a003f139478e75af0a3a4db50342fc25796740f0b187b94b78afa86e9dea806d61a045de899863a9c9405215907ee020de8c2c3668edf3cfcf4a868abf94b4084241a06b8bf68e0495279360e25598a4b3bd7450578f4cdbbbb618f6ac4cbbc73d0d89a0dafee061e758274bee84f8fa6df933ace88c96618837543ccd752bda16e1b11ca008cb5fd03f8dc430e61ae9228648fbed1a2fcfe81a2341b5a842a1203b912854a0b8d777d015f0b66b25fb3bed354fccf64541108828b7f8dce7cb6f7a2c7b15e8a0d581f43db340358b59476ff853c5a627471c4df2f2baf1fd450b8f9aca650622a0f1bf0b017201301757f432e7559f9231576b38c007d8be227d3ceaff4e9054fba0d3dfd89378794d18044a4e54c96ff60e99308bffdbf29b424d5ab6ec7933566fa0e3234869f8a243407b7cf5280cdb4cdf60866e26f324395c0ba21351d931b4a0a0bab778f165b8c8806d8058abbba694102db5e5898dcf65448e471fc5daf7632680f90211a0deb9561c8202eeb1088becdc19f2b87cfe94a10497b4fb58c9a1e38ae90a915ca0a466ac165a3e0b1f50b6454c99c10cc5c41503d4f0c3cf871ee5d6b88d3393f1a057e8fb3a3f532083b1ad47c961473608292768bda30208aab18aac186dd7726fa07b412ee1626842fb754ccc72587ea7a058db91da478d1abafc40209cd8ce7df1a055ad83292693cce77321ff7df1807ffac7dea4f1cd1e7501c71c29b1c736a5d9a0b477344d447ee0014bf9021593a4f45ff5beba1b8b78a08a42f2418485038925a072c645d4a2fd1d362b0b5e0489d83ea8cdb8485d35625caf65f1d3a6076bf8c5a02ffda44f5572fc0d077096bf56d754a94896eb2c89fbc56c2a7a3897abbbb2b2a0aebb9af57494d972874f9a72beb9f079765a43ec16baf122d8c1265f78fcc2c6a03095b7311c4a8c6ab593d03a39fe5b41db884a51369822167b8b618f98dbc0eea08b355e0cce07425f2f02ae40385e2b21e0e3da32cb7b0a6f4aba06690a961166a0939d02dfc357824044d3f0cafcb781f46ec45da4b25836f09b682f9536d120efa0dbeda80bd4f404c73d14fba54915f5328fb51ac4e4536a29c586e1cafe214c21a0152540adefc403d3032bdeb54cc74930b29f687945115e2d4cd9494f69ef6844a069a290528dde4285fb8e628ffccbf1fb69b82f5cc5198128b4dc1eabbc765a4ba0e46855e23be7d591137302942bf4637e44a77844294f9a8caae81f13826a689580f90211a0d5dba92148fb213294b687fefa76f14277ff871a2c6c584d9a0b591a6414de67a012deccc7b0f50a019cb85858f3261d85c4e8b5458712e74f47b65b656d24cacaa07f1791abfc2c5240b5c2ef8667df3d1469a0cdf07131a7df024197f7c9d074eaa0f088f24f3a92c4c2ab2e4fc474c1b92259d1e02a98078b05e57f4a3e80e9fb59a098d73378302969ee6f255f5db38bfa44dc9b0df7674597345f322c24237851efa0460401be8388ad1a8e02d09a662b7c6274c66c1bcdcd2317b2c99e49d283a34ea0f34b5119985bfbdd50feb8c5ccd3bef1f9cceca022bdcea082d541b340a8347ba0de3e68b7e3e64df5b06ca52a615d6c9f00322344f7557bc3c95050b792b86272a06f2c2a0d8e8d27cbac3f02aba212eeb79f80a6868a58c96ba7ae8d0446cce694a049d95d4d82b7defb3d193052598ddbbac648235e383dcbe535a2fc493cd3e39ba0df07b16cbd8a44ea53e8e75d1eebb6ab67fc0e5f2447d8e5768fabf68f02bbc8a038d19ec63584588b2f93cd80c161d1827cf054a2f9cef63d1470654b9c681fcfa0907eaaaa3693594e95941637e9f4c3f83ce02a14cf8fc2cb02418dbdbc043839a0171bd79602ff7c303083d1e3774ed0c77309afdb5be6f12396fce392ba52312da0cb54daa5193ee3efc0e2afbe0a1b13e5418a570220dff9063b322cc07785100ca0a7daeeef3b2e9b542906cd982a7860c1eb8652b776deb2d7db954031a595c06b80f90211a010a55b10828dc87c870bf7ffc1f17e490bfedef06b447f44d5cb05f987a55192a0998e2744898f5abc5c55a7670eac383e750761ea7873ab929e89882767f9b29fa0e7430cf5391d79c45edcbf4a9f267b95a90b764245987dbfb940f386f1c97eaaa08abfb3ebb057cb9f26960a5ce0ce3b016f85f4b54020928de70f6b0e8efbc6f8a0d2013763bdd3e8138663674d44aa6a01c43a1673590f8f5583354019d047c33fa0bf8c3a2443fa424fafd3041c191b23cb9df88ee80d2a6b2eac62414252aec47fa099081275005ca12f20335b1bea768f1da0625f9c0d6128839169c9036da1c3b2a0b19fd624a64340cdf3134fa715926ec4c9a7bde61e5b7d5ba976339c5d11c6f8a0555cb85d214d24f3f017771c2eea86d3c1e2850cba545eff8f7cf068a6fbe5c5a0deffdb2431042577063cd124835ff348ae4d5d1dbce3cc0da0840cd6bad593d0a074b243b4cbac7dfaf229ec5ed8f960d2c8d8ea74ae2d23853c527e0f284fe6b5a023f1b3c16d7540223ae68038b414a7a8dac63c44d565dbf5b6103a30c2e037a8a0d5fd5c6a69fd42bf9b8393e2a003ba5e09caefccfa5f3afc437baf6276d831f7a0f0b24f2057ef2fda74acbd3eeb37463eb41a59d95b7efdb04071e990af593b7ba0d8a5a745362753801c7d31d8c70d00abf5c298044066a91b164578c20bfce227a03224b86f2f7fcdae70c0bad45c1b743d37f344bc2e62922723624b562765425d80f90191a08190beca2fa9132ec0e66a0941160b478e8a5d709c445dd8e60a2714e3bf7454a0bb28b0642a3f59da9b458f985a3123f44e11bb66c4a17048cc636b4c381ae45680a0c70b7be01895bc02247cd4c32faa6f395a33437340fbc5281a386bc17f62da0ca08ca208e9e2e0046decaf23092891d897a2c481ecb7baf7d4baa8b79e9463d072a085170ab1325f84f6da3902311f5367b1d7cdc456e2faff883e5f5a77cc06801ea01f7446d0aa0c9105a7d0895b32999e1ca262f4323bfe595fc8c47941159dbb24a09385ff36324631c8ae1eb4d3e40b1bf21e74e4dc8b9a8e914f7312371780d024a05cb9ae2531f250141a58cece3694ab04da3dfa9fe10364b3e955ab0f8d7df27fa0ee414ba7ce4ad05131e96e154a5163328bc0da65a019553d828ead34e5be22b080a01a355ce465305852dad4e8a78749e33fb47eb53723552232d6ff7aba74a1d870a0cb6e0c992b267823039107b3de67893235f7452d75ecc6504ae0d85722fdc0be80a039978eb3ab27721875bc507611aa50434fff2f2f16b27943685f08a40cc9e4628080f8679e205e7c0ddb68e10d8432e66d6351acc6baf80161e6088af210fee0815cd6b846f8440180a0c451881707b89b35f5b838c07894b6f5eca4a5415941625e5916e3c06870207ca0227a99a2297d05d1bea5114772e59611991c4aa2f1ebb0d23330b02173426c23", 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266, hex"f8ebf8b1a0baefd740d886a75a00998f859f788b55e7d7db1843b5ed550e8135c3a45e0c1d808080a0df1326d6c2c3e493d1bfff3543916a258519bb6365d62334d217e8a0efd0a19e808080a0670f9fb6e73ff93d538f7cc92c723f51d7df32d94d16848b51289260eb21292c8080a0c2c2ff8fbb388b92799847764ccadb622f5e8464f13c8aec173f8ee8ebda8e2fa0849db0f7b77fc361400b0f26d1e39ebc8f1a421829839c9bafa80be0a14feba680808080f7a0336b6384b5eca791c62761152d0c79bb0604c104a5fb6f4eb0703f3154bb3db09594f39fd6e51aad88f6f4ce6ab8827279cfffb92266");

	(address newSignKey, uint256 blockNumber) = keystoreProofContract.getKeystoreBySlot(hex"0000000000000000000000000000000000000000000000000000000000000005");
	assertEq(newSignKey, 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266);
	assertEq(blockNumber, 9272430);
	
    }
}